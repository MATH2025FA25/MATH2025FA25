{
  "hash": "838c0a0ae73830c04c0bd75658bf2c28",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AE 10: Logistic Regression Inference\"\neditor: visual\nformat:\n  html:\n    embed-resources: true\n---\n\n\n\n::: callout-important\n-   Open [RStudio](https://rstudio.collegeofidaho.edu/) and create a subfolder in your AE folder called \"AE-10\".\n\n-   Go to the [Canvas](https://cofi.instructure.com/courses/17093/assignments/202848) and locate your `AE-10` assignment to get started.\n\n-   Upload the `ae-10.qmd` and `framingham.csv` files into the folder you just created.\n:::\n\n## Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(ggformula)\nlibrary(mosaic)\nlibrary(knitr)\n\nheart_disease <- read_csv(\"../data/framingham.csv\") |>\n  select(totChol, TenYearCHD, age, BMI, cigsPerDay, heartRate, sysBP, diabetes) |>\n  drop_na()\n```\n:::\n\n\n\n### Data: Framingham study\n\nThis data set is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. We want to predict if a randomly selected adult is high risk for heart disease in the next 10 years.\n\n### Response variable\n\n-   `TenYearCHD`:\n    -   1: Patient developed heart disease within 10 years of exam\n    -   0: Patient did not develop heart disease within 10 years of exam\n\n### What's my predictor variable?\n\nBased on your group, use the following as your predictor variable.\n\n-   Group 1 - `totChol`: total cholesterol (mg/dL)\n-   Group 2 -`BMI`: patient's body mass index\n-   Group 3 -`cigsPerDay`: number of cigarettes patient smokes per day\n-   Group 4 -`heartRate`: Heart rate (beats per minute)\n\n### Additional Variables\n\n-   `sysbp` - the patients systolic blood pressure at the time of examination\n\n-   `diabetes` - 1 if the patient had diabetes and 0 if the patient didn't have diabetes at the time of examination\n\n## Exercise 0\n\nFit a logistic regression model predicting `TenYearCHD` from your group's predictor variable. Note that we won't return to this model until Exercise 3.\n\n## Exercise 1\n\nBefore you work on your own model, lets consider the variable `sysBP` which represents the patients systolic blood pressure (the top number). You have five minutes, find the $\\beta$'s that result in the largest log-likelihood for a logistic regression model predicting the risk of coronary heart disease from `sysBP`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Change these\nbeta0 <- 0\nbeta1 <- 0\n\n\n# Don't change anything below this line\npredicted_probabilities <- exp(beta0 + beta1*heart_disease$sysBP)/(1+exp(beta0 + beta1*heart_disease$sysBP))\nlog_likelihoods <- heart_disease$TenYearCHD*log(predicted_probabilities) +\n                        (1-heart_disease$TenYearCHD)*log(1-predicted_probabilities)\n\n# Final log likelihood\nsum(log_likelihoods)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -2871.016\n```\n\n\n:::\n:::\n\n\n\n## Exercise 2\n\nCompute the empirical logit for each level of `diabetes`:\n\n1.  Use the function `tally` to compute the count the number of successes and failures for each level of `diabetes`.\n2.  Compute the empirical odds.\n3.  Compute the log of these odds.\n\n## Exercise 3\n\nIs linearity satisfied for the model you fit in Exercise 0?\n\n## Exercise 4\n\nFor your quantitative predictor, conduct a hypothesis test to determine whether the slope of your variable is statistically significant. On the white board:\n\n1.  Specify the null and alternative hypotheses.\n2.  Compute the test statistic.\n3.  Give the p-value.\n4.  Interpret the result.\n\n## Exercise 5\n\nFor your quantitative variable. Construct a 99% confidence interval. Hint, you can use the `conf.level` argument in `tidy` to change the confidence level. On the white board:\n\n1.  Interpret your confidence interval in *log-odds*.\n2.  Interpret your confidence interval in *odds*.\n\n## Exercise 6\n\nConduct a hypothesis test for your $\\beta_1$. Interpret it in context and be prepared to discuss with the class. Note that you need not write down the entire hypothesis testing framework.\n\n## Exercise 7\n\nWhy do you think it doesn't quite make sense to talk about prediction intervals or confidence intervals in the context of a logistic regression model?\n\n## Exercise 8\n\nCompute the deviance for the model you fit above. Do larger or smaller values of deviance indicate a better model?\n\n## Exercise 9\n\nIn Exercise 6, we used a \\_\\_\\_\\_ test to compute our p-value. Test the same hypotheses, this time using a likelihood ratio test. Write out all the steps on the white board, following the slides :\n\n1.  Specify the null and alternative hypotheses.\n2.  Compute the test statistic.\n3.  Give the p-value. Draw a picture!\n4.  Interpret the result.\n\n## Exercise 10\n\nThe test statistic for a LRT is the difference in deviance between your full and reduced model:\n\n1.  Do larger or smaller values of your test statistic provide more evidence for the alternative hypothesis?\n2.  Do you think your test statistic can ever be negative? Why? Do not use the Chi-Squared distribution to justify your answer.\n\n## Exercise 11\n\nUse the `anova` function to recreate your p-value from the previous problem.\n\n## Exercise 12\n\nAre the p-values you got from Exercises 6, 9, and 11 all the EXACT same? Make sure you are displaying enough digits so that your p-values aren't rounding to zero. If they are different, which one do you think is the most reliable? Why?\n\n## Submission\n\n::: callout-important\nTo submit the AE:\n\n-   Render the document to produce the HTML file with all of your work from today's class.\n-   Upload your QMD and HTML files to the Canvas assignment.\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}