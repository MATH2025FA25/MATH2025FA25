{
  "hash": "910473e0897c9d87bacb41cad86861c4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AE 06: Model evaluation\"\neditor: visual\nformat:\n  html:\n    embed-resources: true\n---\n\n\n\n::: callout-important\n-   Open [RStudio](https://rstudio.collegeofidaho.edu/) and create a subfolder in your AE folder called \"AE-06\"\n\n-   Go to the [Canvas](https://cofi.instructure.com/courses/17093/assignments/202834) and locate your `AE 06` assignment to get started.\n\n-   Upload the `ae-05.qmd` and `spotify-popular.csv` files into the folder you just created.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggformula)\nlibrary(mosaic)\nlibrary(broom)\nlibrary(knitr)\nlibrary(patchwork) #arrange plots in a grid\n```\n:::\n\n\n\n## Data\n\nThe data set for this assignment is a subset from the [Spotify Songs](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-01-21/readme.md) Tidy Tuesday data set. The data were originally obtained from Spotify using the **spotifyr** R package.\n\nIt contains numerous characteristics for each song. You can see the full list of variables and definitions [here](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-01-21/readme.md). This analysis will focus specifically on the following variables:\n\n| variable | class | description |\n|:--------|:--------|:------------------------------------------------------|\n| track_id | character | Song unique ID |\n| track_name | character | Song Name |\n| track_artist | character | Song Artist |\n| track_popularity | double | Song Popularity (0-100) where higher is better |\n| energy | double | Energy is a measure from 0.0 to 1.0 and represents a perceptual measure of intensity and activity. Typically, energetic tracks feel fast, loud, and noisy. For example, death metal has high energy, while a Bach prelude scores low on the scale. Perceptual features contributing to this attribute include dynamic range, perceived loudness, timbre, onset rate, and general entropy. |\n| valence | double | A measure from 0.0 to 1.0 describing the musical positiveness conveyed by a track. Tracks with high valence sound more positive (e.g. happy, cheerful, euphoric), while tracks with low valence sound more negative (e.g. sad, depressed, angry). |\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspotify <- read_csv(\"../data/spotify-popular.csv\")\n```\n:::\n\n\n\nAre high energy songs more positive? To answer this question, we'll analyze data on some of the most popular songs on Spotify, i.e. those with `track_popularity >= 80`. We'll use linear regression to fit a model to predict a song's positiveness (`valence`) based on its energy level (`energy`).\n\nBelow are plots as part of the exploratory data analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- gf_histogram(~valence, data = spotify) |>  \n  gf_labs(title = \"Distribution of Valence\", \n       subtitle = \" for Popular songs on Spotify\", \n       x = \"Valence\")\n\np2 <- gf_histogram(~energy, data = spotify) |> \n  gf_labs(title = \"Distribution of Energy\", \n       subtitle = \"for Popular songs on Spotify\", \n       x = \"Energy\")\np1 + p2\n```\n\n::: {.cell-output-display}\n![](ae-06-model-eval_files/figure-html/univariate-eda-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_point(valence ~ energy, data = spotify) |> \n  gf_labs(title = \"Valence vs. Energy\", \n       subtitle = \"Popular songs on Spotify\", \n       x = \"Energy\", \n       y = \"Valence\")\n```\n\n::: {.cell-output-display}\n![](ae-06-model-eval_files/figure-html/bivariate-eda-1.png){width=672}\n:::\n:::\n\n\n\n## Model with 90% CI for coefficients\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspotify_fit <- lm(valence ~ energy, data = spotify)\n\ntidy(spotify_fit, conf.int = TRUE, conf.level = 0.9) |> \n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:-----------|--------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept) |    0.121|     0.035|     3.401|   0.001|    0.062|     0.179|\n|energy      |    0.614|     0.054|    11.321|   0.000|    0.525|     0.703|\n\n\n:::\n:::\n\n\n\n## Create augmented data frame\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspotify_aug <- augment(spotify_fit)\n```\n:::\n\n\n\n## Create residual plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_point(.resid ~ .fitted, data = spotify_aug) |>  \n  gf_hline(yintercept = 0, color = \"red\", linetype = \"dashed\") |> \n  gf_labs(x = \"Fitted values\", \n       y = \"Residuals\", \n       title = \"Residuals vs. fitted\")\n```\n\n::: {.cell-output-display}\n![](ae-06-model-eval_files/figure-html/resid-vs-fitted-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresid_hist <- gf_histogram(~.resid, data = spotify_aug) |>  \n  gf_labs(x = \"Residuals\", \n       title = \"Distribution of residuals\")\n\nresid_qq <- gf_qq(~.resid, data = spotify_aug) |> \n  gf_qqline()  |> \n  gf_labs(x = \"Theoretical quantiles\",\n       y = \"Observed residuals\", \n       title = \"Normal QQ-plot\")\n\nresid_hist + resid_qq\n```\n\n::: {.cell-output-display}\n![](ae-06-model-eval_files/figure-html/resid-dist-1.png){width=672}\n:::\n:::\n\n\n\n## Exercise 1\n\nCalculate $R^2$ and interpret this value in the context of the data.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Exercise 2\n\nCalculate RMSE and interpret this value in the context of the data.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n```         \n    \\newcommand{\\E}{\\mathbb{E}}\n    \\newcommand{\\Var}{\\text{Var}}\n    \\newcommand{\\SD}{\\text{SD}}\n    \\newcommand{\\PP}{\\text{P}}\n    \\newcommand{\\bq}{\\begin{questions}}\n    \\newcommand{\\eq}{\\end{questions}}\n    \\newcommand{\\bp}{\\begin{parts}}\n    \\newcommand{\\ep}{\\end{parts}}\n    \\newcommand{\\bs}{\\begin{subparts}}\n    \\newcommand{\\es}{\\end{subparts}}\n```\n\n## Exercise 3\n\nChoose another quantitative variable in the data set. Check [here](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-01-21/readme.md) for specific definitions of variables. After Dr. Friedlander approves your choice, fit a model predicting `valence` using that variable as a predictor. Make an argument, citing quantitative evidence, for which model is better, the energy model or your new model. Reporters, be ready to discuss with the class.\n\n## To submit the AE:\n\n::: callout-important\n-   Render the document to produce the PDF with all of your work from today's class.\n-   Upload your QMD and PDF files to the Canvas assignment.\n:::\n",
    "supporting": [
      "ae-06-model-eval_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}