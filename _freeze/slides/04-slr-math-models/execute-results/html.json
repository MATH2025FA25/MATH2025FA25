{
  "hash": "5e4e5712a3a6dafedc73d6735bed4f2d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"SLR: Mathematical models for inference\"\nauthor: \"Prof. Eric Friedlander\"\nfooter: \"[ðŸ”— MAT 212 - Winter 2025 -  Schedule](https://mat212wi25.netlify.app/schedule)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: false\n    incremental: false \n    chalkboard: true\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\n  cache: false\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib  \n---\n\n\n\n\n# Application exercise\n\n::: appex\nðŸ“‹ [AE 04: Randomization test for the slope](/ae/ae-04-math-models.qmd)\n:::\n\nComplete Exercises 0 and 1.\n\n# Mathematical models for inference\n\n## Topics\n\n-   Define mathematical models to conduct inference for the slope\n\n-   Use mathematical models to\n\n    -   calculate confidence interval for the slope\n\n    -   conduct a hypothesis test for the slope\n    \n    -   calculate confidence intervals for predictions\n\n## Computational setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)   # for data wrangling and visualization\nlibrary(broom)       # for formatting model output\nlibrary(scales)      # for pretty axis labels\nlibrary(knitr)       # for pretty tables\nlibrary(kableExtra)  # also for pretty tables\nlibrary(patchwork)   # arrange plots\n\n# Spotify Dataset\nspotify <- read_csv(\"../data/spotify-popular.csv\")\n\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_bw(base_size = 20))\n```\n:::\n\n\n\n## The regression model, revisited\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspotify_fit <- lm(danceability ~ duration_ms, data = spotify)\n\ntidy(spotify_fit) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) |    0.781|     0.028|    28.351|   0.000|\n|duration_ms |    0.000|     0.000|    -3.151|   0.002|\n\n\n:::\n:::\n\n\n\n## Inference, revisited {.midi}\n\n::: incremental\n-   Earlier we computed a confidence interval and conducted a hypothesis test via simulation:\n    -   CI: Bootstrap the observed sample to simulate the distribution of the slope\n    -   HT: Permute the observed sample to simulate the distribution of the slope under the assumption that the null hypothesis is true\n-   Now we'll do these based on theoretical results, i.e., by using the Central Limit Theorem to define the distribution of the slope and use features (shape, center, spread) of this distribution to compute bounds of the confidence interval and the p-value for the hypothesis test\n:::\n\n## Mathematical representation of the model {.midi}\n\n$$\n\\begin{aligned}\nY &= Model + Error \\\\\n&= f(X) + \\epsilon \\\\\n&= \\mu_{Y|X} + \\epsilon \\\\\n&= \\beta_0 + \\beta_1 X + \\epsilon\n\\end{aligned}\n$$\n\nwhere the errors are independent and normally distributed:\n\n. . .\n\n-   **independent**: Knowing the error term for one observation doesn't tell you anything about the error term for another observation\n-   **normally distributed**: $\\epsilon \\sim N(0, \\sigma_\\epsilon^2)$\n\n## Mathematical representation, visualized {.midi}\n\n$$\nY|X \\sim N(\\beta_0 + \\beta_1 X, \\sigma_\\epsilon^2)\n$$\n\n::: columns\n::: {.column width=\"70%\"}\n![Image source: *Introduction to the Practice of Statistics (5th ed)*](images/04/regression.png)\n:::\n\n::: {.column width=\"30%\"}\n-   Mean: $\\beta_0 + \\beta_1 X$, the predicted value based on the regression model\n-   Variance: $\\sigma_\\epsilon^2$, constant across the range of $X$\n    -   How do we estimate $\\sigma_\\epsilon^2$?\n:::\n:::\n\n## Regression standard error {.smaller}\n\nOnce we fit the model, we can use the residuals to estimate the **regression standard error**, the average distance between the observed values and the regression line\n\n$$\n\\hat{\\sigma}_\\epsilon = \\sqrt{\\frac{\\sum_\\limits{i=1}^n(y_i - \\hat{y}_i)^2}{n-2}} = \\sqrt{\\frac{\\sum_\\limits{i=1}^ne_i^2}{n-2}}\n$$\n\n. . .\n\n-  We divide by $n - 2$ because we have $n-2$ **degrees of freedom**\n\n\n::: question\nWhy do we care about the value of the regression standard error?\n:::\n\n## Standard error of $\\hat{\\beta}_1$ {.smaller}\n\nThe **standard error of** $\\hat{\\beta}_1$ quantifies the sampling variability in the estimated slopes\n\n$$\nSE_{\\hat{\\beta}_1} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{(n-1)s_X^2}}\n$$\n\n. . .\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.809197e-01 </td>\n   <td style=\"text-align:right;\"> 2.754508e-02 </td>\n   <td style=\"text-align:right;\"> 2.835061e+01 </td>\n   <td style=\"text-align:right;\"> 0.000000e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> duration_ms </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -4.039000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.282000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -3.150955e+00 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.723739e-03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n# Mathematical models for inference for $\\beta_1$\n\n## Hypothesis test for the slope {.midi}\n\n**Hypotheses:** $H_0: \\beta_1 = 0$ vs. $H_A: \\beta_1 \\ne 0$\n\n. . .\n\n**Test statistic:** Number of standard errors the estimate is away from the null\n\n$$\nT = \\frac{\\text{Estimate - Null Value}}{\\text{Standard error}} \\\\\n$$\n\n. . .\n\n**p-value:** Probability of observing a test statistic at least as extreme (in the direction of the alternative hypothesis) from the null value as the one observed\n\n$$\n\\text{p-value} = P(|T| > |\\text{test statistic}|),\n$$\n\ncalculated from a $t$ distribution with $n - 2$ degrees of freedom\n\n## Hypothesis test: Test statistic {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.809197e-01 </td>\n   <td style=\"text-align:right;\"> 2.754508e-02 </td>\n   <td style=\"text-align:right;\"> 2.835061e+01 </td>\n   <td style=\"text-align:right;\"> 0.000000e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> duration_ms </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -4.039000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.282000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -3.150955e+00 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.723739e-03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n$$\nT = \\frac{\\hat{\\beta}_1 - 0}{SE_{\\hat{\\beta}_1}} = \\frac{-4.04\\times 10^{-7} - 0}{1.28\\times 10^{-7}} \\approx -3.15\n$$\n\nOur observed slope, $\\hat{\\beta_1} = -4.04\\times 10^{-7}$, is $3.15$ standard errors **below** what we would expect if there were no linear relationship between `duration_ms` and `danceability`.\n\n. . .\n\nComplete Exercise 2 and 3.\n\n## Hypothesis test: p-value {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.809197e-01 </td>\n   <td style=\"text-align:right;\"> 2.754508e-02 </td>\n   <td style=\"text-align:right;\"> 2.835061e+01 </td>\n   <td style=\"text-align:right;\"> 0.000000e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> duration_ms </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -4.039000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.282000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -3.150955e+00 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.723739e-03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](04-slr-math-models_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n\n## Hypothesis test: p-value {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.809197e-01 </td>\n   <td style=\"text-align:right;\"> 2.754508e-02 </td>\n   <td style=\"text-align:right;\"> 2.835061e+01 </td>\n   <td style=\"text-align:right;\"> 0.000000e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> duration_ms </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -4.039000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.282000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -3.150955e+00 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.723739e-03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n. . .\n\nThe probability of obtaining an observed slope providing stronger evidence for the alternative hypothesis, **if we assume that the null hypothesis is true**, is $1.72\\times 10^{-3}$.\n\n## Understanding the p-value\n\n| Magnitude of p-value    | Interpretation                        |\n|:------------------------|:--------------------------------------|\n| p-value \\< 0.01         | strong evidence against $H_0$         |\n| 0.01 \\< p-value \\< 0.05 | moderate evidence against $H_0$       |\n| 0.05 \\< p-value \\< 0.1  | weak evidence against $H_0$           |\n| p-value \\> 0.1          | effectively no evidence against $H_0$ |\n\n::: callout-important\nThese are general guidelines. The strength of evidence depends on the context of the problem.\n:::\n\n## Hypothesis test: Conclusion, in context {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.809197e-01 </td>\n   <td style=\"text-align:right;\"> 2.754508e-02 </td>\n   <td style=\"text-align:right;\"> 2.835061e+01 </td>\n   <td style=\"text-align:right;\"> 0.000000e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> duration_ms </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -4.039000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.282000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -3.150955e+00 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.723739e-03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n-   The data provide convincing evidence that the population slope $\\beta_1$ is different from 0.\n-   The data provide convincing evidence of a linear relationship between the duration of a song and it's danceability.\n\n. . .\n\nComplete Exercises 4-7.\n\n## Confidence interval for the slope\n\n$$\n\\text{Estimate} \\pm \\text{ (critical value) } \\times \\text{SE}\n$$\n\n. . .\n\n$$\n\\hat{\\beta}_1 \\pm t^* \\times SE_{\\hat{\\beta}_1}\n$$\n\nwhere $t^*$ is calculated from a $t$ distribution with $n-2$ degrees of freedom\n\n## Confidence interval: Critical value\n\n::: {.fragment fragment-index=\"1\"}\n::: columns\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# confidence level: 95%\nqt(0.975, df = nrow(spotify) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.964663\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](04-slr-math-models_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n:::\n\n::: {.fragment fragment-index=\"2\"}\n::: columns\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# confidence level: 90%\nqt(0.95, df = nrow(spotify) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.647871\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](04-slr-math-models_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n:::\n\n::: {.fragment fragment-index=\"3\"}\n::: columns\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# confidence level: 99%\nqt(0.995, df = nrow(spotify) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.58558\n```\n\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"40%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](04-slr-math-models_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n\n:::\n:::\n:::\n\n## 95% CI for the slope: Calculation {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.809197e-01 </td>\n   <td style=\"text-align:right;\"> 2.754508e-02 </td>\n   <td style=\"text-align:right;\"> 2.835061e+01 </td>\n   <td style=\"text-align:right;\"> 0.000000e+00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> duration_ms </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -4.039000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.282000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -3.150955e+00 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.723739e-03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n$$\\hat{\\beta}_1 = -4.04\\times 10^{-7} \\hspace{15mm} t^* = 1.96  \\hspace{15mm} SE_{\\hat{\\beta}_1} = 1.28\\times 10^{-7}$$\n\n. . .\n\n$$\n -4.04\\times 10^{-7} \\pm 1.96 \\times 1.28\\times 10^{-7} = (-6.55\\times 10^{-7}, -1.53\\times 10^{-7})\n$$\n\n## 95% CI for the slope: Computation {.smaller}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(spotify_fit, conf.int = TRUE, conf.level = 0.95) |>\n   kable(digits = 10, format.args = list(scientifi = TRUE))|>\n  row_spec(2, background = \"#D9E3E4\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 7.809197e-01 </td>\n   <td style=\"text-align:right;\"> 2.754508e-02 </td>\n   <td style=\"text-align:right;\"> 2.835061e+01 </td>\n   <td style=\"text-align:right;\"> 0.000000e+00 </td>\n   <td style=\"text-align:right;\"> 7.268029e-01 </td>\n   <td style=\"text-align:right;\"> 8.350365e-01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> duration_ms </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -4.039000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.282000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -3.150955e+00 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 1.723739e-03 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -6.557000e-07 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> -1.520000e-07 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nWe are 95% confident that, as the duration of a song increases by 1 millisecond, the danceability of that song will **decrease** by  $1.53\\times 10^{-7}$ to $6.56\\times 10^{-7}$ units.\n\n. . .\n\nComplete Exercises 7-10.\n\n# Intervals for predictions\n\n## Intervals for predictions {.smaller}\n\n-   Question: *\"What is the predicted danceability for a 3 minute (180,000 ms) song?\"*\n-   We said reporting a single estimate for the slope is not wise, and we should report a plausible range instead\n-   Similarly, reporting a single prediction for a new value is not wise, and we should report a plausible range instead\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](04-slr-math-models_files/figure-revealjs/unnamed-chunk-16-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n## Two types of predictions\n\n1.  Prediction for the mean: \"What is the average predicted danceability for three minute songs?\"\n\n2.  Prediction for an individual observation: \"What is the predicted danceability for the new Magdala Bay song which is exactly three minutes long?\"\n\n. . .\n\n::: question\nWhich would you expect to be more variable? The average prediction or the prediction for an individual observation? Based on your answer, how would you expect the widths of plausible ranges for these two predictions to compare?\n:::\n\n## Uncertainty in predictions\n\n**Confidence interval for the mean outcome:** $$\\large{\\hat{y} \\pm t_{n-2}^* \\times \\color{purple}{\\mathbf{SE}_{\\hat{\\boldsymbol{\\mu}}}}}$$\n\n. . .\n\n**Prediction interval for an individual observation:** $$\\large{\\hat{y} \\pm t_{n-2}^* \\times \\color{purple}{\\mathbf{SE_{\\hat{y}}}}}$$\n\n## Standard errors\n\n**Standard error of the mean outcome:** $$SE_{\\hat{\\mu}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n. . .\n\n**Standard error of an individual outcome:** $$SE_{\\hat{y}} = \\hat{\\sigma}_\\epsilon\\sqrt{1 + \\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n## Standard errors\n\n**Standard error of the mean outcome:** $$SE_{\\hat{\\mu}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n**Standard error of an individual outcome:** $$SE_{\\hat{y}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\mathbf{\\color{purple}{\\Large{1}}} + \\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n## Confidence interval\n\nThe 95% **confidence interval** for the *mean* outcome:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_songs <- tibble(duration_ms = 180000)\n\npredict(spotify_fit, newdata = new_songs, interval = \"confidence\", \n        level = 0.95) |>\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|       fit|       lwr|       upr|\n|---------:|---------:|---------:|\n| 0.7082244| 0.6945675| 0.7218813|\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n. . .\n\nWe are 95% confident that the *mean* danceability for new popular three minute songs on Spotify will be between 0.69 and 0.72. \n\n## Prediction interval\n\nThe 95% **prediction interval** for an *individual* outcome:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_song <- tibble(duration_ms = 180000)\n\npredict(spotify_fit, newdata = new_song, interval = \"prediction\", \n        level = 0.95) |>\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|       fit|       lwr|       upr|\n|---------:|---------:|---------:|\n| 0.7082244| 0.4518935| 0.9645553|\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n. . .\n\nWe are 95% confident that the new Magdala Bay song that is exactly three minutes long will have a danceability between 0.45 and 0.96.\n\n## Comparing intervals\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](04-slr-math-models_files/figure-revealjs/unnamed-chunk-21-1.png){width=100%}\n:::\n:::\n\n\n\n. . .\n\nComplete Exercises 11 and 12.\n\n## Extrapolation\n\nUsing the model to predict for values outside the range of the original data is **extrapolation**.\n\n. . .\n\n::: columns\n::: {.column width=\"55%\"}\n::: question\nCalculate the prediction interval for the danceability of a song which is 20 minutes (1.2 Million milliseconds) song.\n:::\n\n[*No, thanks!*]{.fragment}\n:::\n\n::: {.column width=\"45%\"}\n![AI Generated Image of \"Funny people dancing. Add in silly dance moves and make them look tired.\"](images/04/dancing.png){fig-align=\"center\"}\n:::\n:::\n\n\n\n## Extrapolation\n\n::: question\nWhy do we want to avoid extrapolation?\n:::\n\n## 2005 be like: OMG HOUSING PRICES ARE GOING TO INCREASE FOREVER, YOUR CREDIT DOESN'T MATTER\n\n![](images/04/case-shiller1.png){fig-align=\"center\"}\n\n## 2007 be like: LOL NO\n\n![](images/04/case-shiller2.png){fig-align=\"center\"}\n\n## Recap\n\n-   Learned how to use mathematical models to\n\n    -   calculate confidence interval for the slope\n\n    -   conduct a hypothesis test for the slope\n    \n    -   calculate confidence intervals for predictions\n    \n        -   predictions of averages: \"confidence intervals\"\n        \n        -   predictions for single observations: \"prediction intervals\"",
    "supporting": [
      "04-slr-math-models_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}